webpackJsonp([28],{"FbN+":function(e,n){},"fw+N":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("Dd8w"),s=t.n(a),i=t("Xxa5"),o=t.n(i),c=t("exGp"),d=t.n(c),u=t("OH5c"),r=t("S9Ov"),l=t("FJ7W"),h=[{title:"商品照片",dataIndex:"dishurl",width:100,align:"center",scopedSlots:{customRender:"dishurl"}},{title:"商品名称",dataIndex:"dishname",width:100,align:"center"},{title:"商品价格",width:100,dataIndex:"dishprice",align:"center"},{title:"商品介绍",width:100,dataIndex:"description",align:"center"},{title:"是否显示",width:100,dataIndex:"dishstatus",align:"center",scopedSlots:{customRender:"dishstatus"}},{title:"操作",width:100,dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],f={components:{MenuDishChange:u.default,MenuDishInfo:r.default},data:function(){return{columns:h,dataSource:[],selectedRowKeys:[],loading:!1,switchLoading:!1,show:!1,storeId:0,menuShowVisible:!1,menuChangeVisible:!1,showData:{}}},created:function(){},mounted:function(){var e,n=this;l.a.$on("transferCategory",(e=d()(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.storeId=t.storeId,e.next=3,n.getMenuCategoryList(t);case 3:"空"!==(a=e.sent).data.data[t.category]?n.dataSource=a.data.data[t.category]:n.dataSource=[],n.loading=!1;case 6:case"end":return e.stop()}},e,n)})),function(n){return e.apply(this,arguments)}))},methods:{getMenuCategoryList:function(e){this.loading=!0;var n={storeid:e.storeId};return this.$get("/backend/business/LantianDishmanagement/MapAllByStoreId",s()({},n))},onSelectChange:function(e){this.selectedRowKeys=e},onSwitch:function(e,n){var t=this,a=this;this.switchLoading=!0;var i={id:n.id,dishstatus:e?1:0};this.$put("/backend/business/LantianDishmanagement",s()({},i)).then(function(){a.dataSource.forEach(function(t){t.id===n.id&&(t.dishstatus=e?1:0)}),t.switchLoading=!1,t.$message.success("修改成功")},function(){t.$message.error("修改失败")})},onOpenMenuChangeModal:function(e){this.menuChangeVisible=!0,this.showData=e},onCloseMenuChangeModal:function(){this.menuChangeVisible=!1},onCancelMenuChangeModal:function(){this.menuChangeVisible=!1},onOpenMenushowModal:function(e){this.showData=e,this.menuShowVisible=!0},onCloseMenuShowModal:function(){this.menuShowVisible=!1},onCancelMenuShowModal:function(){this.menuShowVisible=!1},onDeleteMenuDish:function(e){var n=this;this.$delete("/backend/business/LantianDishmanagement/"+e.id).then(function(t){if(200==t.data.code){n.$message.success("删除"+e.dishname+"成功");var a=n.dataSource.filter(function(n){return n.id!=e.id});n.dataSource=a}else n.$message.success("删除删除")})}}},g={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("a-table",{attrs:{dataSource:e.dataSource,columns:e.columns,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},loading:e.loading},scopedSlots:e._u([{key:"dishurl",fn:function(e,n){return t("span",{},[t("img",{staticStyle:{width:"200px",heigth:"auto"},attrs:{src:JSON.parse(n.dishurl)}})])}},{key:"dishstatus",fn:function(n,a){return t("span",{},[t("a-switch",{attrs:{loading:e.switchLoading},on:{change:function(n){e.onSwitch(n,a)}},model:{value:1==a.dishstatus,callback:function(n){e.$set(a,"dishstatus == 1 ? true : false",n)},expression:"record.dishstatus == 1 ? true : false"}},[t("a-icon",{attrs:{slot:"checkedChildren",type:"check"},slot:"checkedChildren"}),e._v(" "),t("a-icon",{attrs:{slot:"unCheckedChildren",type:"close"},slot:"unCheckedChildren"})],1)],1)}},{key:"action",fn:function(n,a){return t("span",{},[t("a",{on:{click:function(n){return e.onOpenMenuChangeModal(a)}}},[e._v("修改")]),e._v(" "),t("a-divider",{attrs:{type:"vertical"}}),e._v(" "),t("a",{on:{click:function(n){return e.onOpenMenushowModal(a)}}},[e._v("查看")]),e._v(" "),t("a-divider",{attrs:{type:"vertical"}}),e._v(" "),t("a-popconfirm",{attrs:{title:"确定删除该菜品","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(n){return e.onDeleteMenuDish(a)}}},[t("a",[e._v("删除")])])],1)}}])}),e._v(" "),t("menu-dish-change",{attrs:{changeVisible:e.menuChangeVisible,data:e.showData},on:{close:e.onCloseMenuChangeModal,cancel:e.onCancelMenuChangeModal}}),e._v(" "),t("menu-dish-info",{attrs:{showVisible:e.menuShowVisible,data:e.showData},on:{close:e.onCloseMenuShowModal,cancel:e.onCancelMenuShowModal}})],1)},staticRenderFns:[]},w=t("VU/8")(f,g,!1,function(e){t("FbN+")},null,null);n.default=w.exports}});