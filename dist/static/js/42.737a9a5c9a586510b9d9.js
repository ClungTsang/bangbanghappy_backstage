webpackJsonp([42],{GciZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("//Fk"),r=n.n(a),s=n("Dd8w"),o=n.n(s),i=n("Xxa5"),c=n.n(i),u=n("exGp"),d=n.n(u),l=n("bOdI"),f=n.n(l),g=n("NYxO"),m=n("FJ7W"),p={data:function(){return f()({category:{text:"切换菜单分类"},items:[],menuCategoryVisible:!1,deleteVisibel:!1,storeId:0},"category",{item:""})},watch:{"category.text":function(e){var t=this;return d()(c.a.mark(function n(){var a;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a={storeId:t.storeId,category:e},m.a.$emit("transferCategory",a);case 2:case"end":return n.stop()}},n,t)}))()}},components:{MenuCategoryAdd:n("jsuz").default,VNodes:{functional:!0,render:function(e,t){return t.props.vnodes}}},created:function(){this.getMenuCategoryInfo()},methods:o()({},Object(g.b)({setUserInfo:"account/setUserInfo"}),{getMenuCategoryInfo:function(){var e=this;return d()(c.a.mark(function t(){var n,a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStoreInfo();case 2:if(null!=(n=t.sent).data.data){t.next=5;break}return t.abrupt("return");case 5:e.setUserInfo(n.data.data),e.storeId=n.data.data.id,a={storeid:e.storeId},e.$get("/backend/business/LantianDishesclassificationtable/MapAllByStoreId",o()({},a)).then(function(t){return e.setMenuCategoryInfo(t.data.data)});case 9:case"end":return t.stop()}},t,e)}))()},setMenuCategoryInfo:function(e){this.items=e},getStoreInfo:function(){var e=this,t=this.$db.get("USER");return new r.a(function(n,a){e.$get("/business/LantianStore/getByPhone/"+t.username).then(function(e){n(e)}).catch(function(e){a(e)})})},addItem:function(){this.menuCategoryVisible=!0},onClose:function(e){this.$message.success("新增"+e.text+"成功"),this.items.push(e),this.menuCategoryVisible=!1},onOpenDelete:function(){this.deleteVisibel=!0},onDeleteOk:function(){var e=this;return d()(c.a.mark(function t(){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.items.filter(function(t){return t.text==e.category.item}),t.next=5,e.$delete("/backend/business/LantianDishesclassificationtable/"+n[0].id).then(function(t){if("仍有以下菜品存在该分类"==t.data.message)e.$message.error("仍有菜品存在该分类");else if(200==t.data.code){e.$message.success("删除"+e.category.item+"成功");var n=e.items.filter(function(t){return t.text!=e.category.item});m.a.$emit("addCategroyOk"),e.items=n}else e.$message.error("删除失败");e.deleteVisibel=!1});case 5:case"end":return t.stop()}},t,e)}))()},onCancel:function(){this.menuCategoryVisible=!1,this.deleteVisibel=!1}})},y={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-select",{staticStyle:{width:"130px"},attrs:{placeholder:"请选择分类"},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return n("div",{},[n("v-nodes",{attrs:{vnodes:t}}),e._v(" "),n("a-divider",{staticStyle:{margin:"4px 0"}}),e._v(" "),n("div",{staticStyle:{padding:"4px 8px",cursor:"pointer"},on:{mousedown:function(e){return e.preventDefault()},click:e.addItem}},[n("a-icon",{attrs:{type:"plus"}}),e._v("添加分类\n      ")],1)],1)}}]),model:{value:e.category.text,callback:function(t){e.$set(e.category,"text",t)},expression:"category.text"}},[e._v(" "),e._l(e.items,function(t){return n("a-select-option",{key:t.id,attrs:{value:t.text}},[e._v("\n      "+e._s(t.text)+"\n    ")])})],2),e._v(" "),n("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.onOpenDelete}},[e._v(" 删除分类 ")]),e._v(" "),n("menu-category-add",{attrs:{addVisible:e.menuCategoryVisible,storeId:e.storeId},on:{close:e.onClose,cancel:e.onCancel}}),e._v(" "),n("a-modal",{attrs:{visible:e.deleteVisibel,title:"删除分类"},on:{ok:e.onDeleteOk,cancel:e.onCancel}},[n("a-radio-group",{attrs:{"button-style":"solid"},model:{value:e.category.item,callback:function(t){e.$set(e.category,"item",t)},expression:"category.item"}},e._l(e.items,function(t){return n("a-radio-button",{key:t.id,staticStyle:{margin:"5px"},attrs:{value:t.text}},[e._v("\n        "+e._s(t.text)+"\n      ")])}),1)],1)],1)},staticRenderFns:[]},v=n("VU/8")(p,y,!1,function(e){n("zSEg")},null,null);t.default=v.exports},zSEg:function(e,t){}});