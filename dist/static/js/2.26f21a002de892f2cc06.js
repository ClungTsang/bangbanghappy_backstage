webpackJsonp([2,28,42,44],{FKRl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("bdJQ"),i=n("jsuz"),s=n("GciZ"),o={components:{MenuCategoryInfo:n("fw+N").default,MenuCategoryAdd:i.default,MenuCategoryChange:s.default,MenuAdd:a.default},data:function(){return{menuCategoryVisible:!1,bordered:!1,menuAddVisible:!1}},methods:{onCancel:function(){this.menuAddVisible=!1},onClose:function(){this.menuAddVisible=!1},onOpen:function(){this.menuAddVisible=!0}}},r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",{attrs:{bordered:e.bordered}},[n("div",[n("a-row",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex"}},[n("a-col",[n("a-button",{attrs:{type:"primary"},on:{click:e.onOpen}},[e._v(" 新增菜品 ")])],1),e._v(" "),n("a-col",{staticStyle:{"margin-left":"10px"}},[n("menu-category-change")],1)],1),e._v(" "),n("menu-add",{attrs:{addVisible:e.menuAddVisible},on:{close:e.onClose,cancel:e.onCancel}}),e._v(" "),n("menu-category-info")],1)])},staticRenderFns:[]},c=n("VU/8")(o,r,!1,function(e){n("zVzY")},null,null);t.default=c.exports},"FbN+":function(e,t){},GciZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("//Fk"),i=n.n(a),s=n("Dd8w"),o=n.n(s),r=n("Xxa5"),c=n.n(r),u=n("exGp"),d=n.n(u),l=n("bOdI"),f=n.n(l),h=n("NYxO"),m=n("FJ7W"),g={data:function(){return f()({category:{text:"切换菜单分类"},items:[],menuCategoryVisible:!1,deleteVisibel:!1,storeId:0},"category",{item:""})},watch:{"category.text":function(e){var t=this;return d()(c.a.mark(function n(){var a;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a={storeId:t.storeId,category:e},m.a.$emit("transferCategory",a);case 2:case"end":return n.stop()}},n,t)}))()}},components:{MenuCategoryAdd:n("jsuz").default,VNodes:{functional:!0,render:function(e,t){return t.props.vnodes}}},created:function(){this.getMenuCategoryInfo()},methods:o()({},Object(h.b)({setUserInfo:"account/setUserInfo"}),{getMenuCategoryInfo:function(){var e=this;return d()(c.a.mark(function t(){var n,a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStoreInfo();case 2:if(null!=(n=t.sent).data.data){t.next=5;break}return t.abrupt("return");case 5:e.setUserInfo(n.data.data),e.storeId=n.data.data.id,a={storeid:e.storeId},e.$get("/backend/business/LantianDishesclassificationtable/MapAllByStoreId",o()({},a)).then(function(t){return e.setMenuCategoryInfo(t.data.data)});case 9:case"end":return t.stop()}},t,e)}))()},setMenuCategoryInfo:function(e){this.items=e},getStoreInfo:function(){var e=this,t=this.$db.get("USER");return new i.a(function(n,a){e.$get("/business/LantianStore/getByPhone/"+t.username).then(function(e){n(e)}).catch(function(e){a(e)})})},addItem:function(){this.menuCategoryVisible=!0},onClose:function(e){this.$message.success("新增"+e.text+"成功"),this.items.push(e),this.menuCategoryVisible=!1},onOpenDelete:function(){this.deleteVisibel=!0},onDeleteOk:function(){var e=this;return d()(c.a.mark(function t(){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.items.filter(function(t){return t.text==e.category.item}),t.next=5,e.$delete("/backend/business/LantianDishesclassificationtable/"+n[0].id).then(function(t){if("仍有以下菜品存在该分类"==t.data.message)e.$message.error("仍有菜品存在该分类");else if(200==t.data.code){e.$message.success("删除"+e.category.item+"成功");var n=e.items.filter(function(t){return t.text!=e.category.item});m.a.$emit("addCategroyOk"),e.items=n}else e.$message.error("删除失败");e.deleteVisibel=!1});case 5:case"end":return t.stop()}},t,e)}))()},onCancel:function(){this.menuCategoryVisible=!1,this.deleteVisibel=!1}})},p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-select",{staticStyle:{width:"130px"},attrs:{placeholder:"请选择分类"},scopedSlots:e._u([{key:"dropdownRender",fn:function(t){return n("div",{},[n("v-nodes",{attrs:{vnodes:t}}),e._v(" "),n("a-divider",{staticStyle:{margin:"4px 0"}}),e._v(" "),n("div",{staticStyle:{padding:"4px 8px",cursor:"pointer"},on:{mousedown:function(e){return e.preventDefault()},click:e.addItem}},[n("a-icon",{attrs:{type:"plus"}}),e._v("添加分类\n      ")],1)],1)}}]),model:{value:e.category.text,callback:function(t){e.$set(e.category,"text",t)},expression:"category.text"}},[e._v(" "),e._l(e.items,function(t){return n("a-select-option",{key:t.id,attrs:{value:t.text}},[e._v("\n      "+e._s(t.text)+"\n    ")])})],2),e._v(" "),n("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.onOpenDelete}},[e._v(" 删除分类 ")]),e._v(" "),n("menu-category-add",{attrs:{addVisible:e.menuCategoryVisible,storeId:e.storeId},on:{close:e.onClose,cancel:e.onCancel}}),e._v(" "),n("a-modal",{attrs:{visible:e.deleteVisibel,title:"删除分类"},on:{ok:e.onDeleteOk,cancel:e.onCancel}},[n("a-radio-group",{attrs:{"button-style":"solid"},model:{value:e.category.item,callback:function(t){e.$set(e.category,"item",t)},expression:"category.item"}},e._l(e.items,function(t){return n("a-radio-button",{key:t.id,staticStyle:{margin:"5px"},attrs:{value:t.text}},[e._v("\n        "+e._s(t.text)+"\n      ")])}),1)],1)],1)},staticRenderFns:[]},v=n("VU/8")(g,p,!1,function(e){n("zSEg")},null,null);t.default=v.exports},bdJQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("fZjL"),i=n.n(a),s=n("Xxa5"),o=n.n(s),r=n("exGp"),c=n.n(r),u=n("Dd8w"),d=n.n(u),l=n("mvHQ"),f=n.n(l),h=n("QiC+"),m=n("NYxO"),g=n("FJ7W"),p={components:{MenuDishUpload:h.default},data:function(){return{form:this.$form.createForm(this),menu:{},category:{item:""},items:[],dishUrl:""}},props:{addVisible:{type:Boolean,default:!1},storeId:{type:Number,default:0}},created:function(){this.getMenuCategoryInfo()},mounted:function(){var e=this;g.a.$on("addCategroyOk",function(){e.getMenuCategoryInfo()}),g.a.$on("dishUrl",function(t){var n=[];t.forEach(function(e){n.push(e.url)}),e.dishUrl=f()(n)})},computed:d()({visible:function(){return this.addVisible}},Object(m.c)({userInfo:function(e){return e.account.userInfo}})),methods:{getMenuCategoryInfo:function(){var e=this;return c()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n={storeid:e.userInfo.id},e.$get("/backend/business/LantianDishesclassificationtable/MapAllByStoreId",d()({},n)).then(function(t){e.items=t.data.data});case 2:case"end":return t.stop()}},t,e)}))()},handleOk:function(){var e=this;this.form.validateFields(function(t,n){if(!t){e.setMenuFields();var a=e.menu;e.$post("/backend/business/LantianDishmanagement",d()({},a,{dishurl:e.dishUrl,storeid:e.category.item.storeid,dishclassificationid:e.category.item.id,dishclassificationname:e.category.item.text})).then(function(){e.$message.success("增加成功"),e.$emit("close"),e.form.resetFields()})}})},handleCancel:function(){this.$emit("cancel"),this.form.resetFields()},uploadImage:function(){this.$refs.UploadImage.afterUpload()},setMenuFields:function(){var e=this,t=this.form.getFieldsValue(["dishname","description","dishprice"]);void 0!==t&&i()(t).forEach(function(n){e.menu[n]=t[n]})}}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-modal",{attrs:{visible:e.visible,title:"新增菜品"},on:{ok:e.handleOk,cancel:e.handleCancel}},[n("a-form",{attrs:{form:e.form}},[n("a-form-item",{attrs:{label:"菜品名称"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["dishname",{rules:[{required:!0,message:"菜品名称不能为空"}]}],expression:"[\n            'dishname',\n            { rules: [{ required: true, message: '菜品名称不能为空' }] },\n          ]"}]})],1),e._v(" "),n("a-form-item",{attrs:{label:"菜品描述"}},[n("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!0,message:"菜品描述不能为空"}]}],expression:"[\n            'description',\n            { rules: [{ required: true, message: '菜品描述不能为空' }] },\n          ]"}]})],1),e._v(" "),n("a-form-item",{attrs:{label:"价格"}},[n("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["dishprice",{rules:[{required:!0,message:"价格不能为空"}]}],expression:"[\n            'dishprice',\n            { rules: [{ required: true, message: '价格不能为空' }] },\n          ]"}]})],1),e._v(" "),n("a-form-item",{attrs:{label:"添加菜品图片"}},[n("menu-dish-upload",[e._v("上传菜品图片")])],1),e._v(" "),n("a-form-item",{staticStyle:{"margin-bottom":"2rem"},attrs:{label:"分类选择"}},[n("a-radio-group",{attrs:{"button-style":"solid"},model:{value:e.category.item,callback:function(t){e.$set(e.category,"item",t)},expression:"category.item"}},e._l(e.items,function(t){return n("a-radio-button",{key:t.id,staticStyle:{margin:"5px"},attrs:{value:t}},[e._v("\n            "+e._s(t.text)+"\n          ")])}),1)],1)],1)],1)],1)},staticRenderFns:[]},b=n("VU/8")(p,v,!1,function(e){n("if12")},null,null);t.default=b.exports},"fw+N":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Dd8w"),i=n.n(a),s=n("Xxa5"),o=n.n(s),r=n("exGp"),c=n.n(r),u=n("OH5c"),d=n("S9Ov"),l=n("FJ7W"),f=[{title:"商品照片",dataIndex:"dishurl",width:100,align:"center",scopedSlots:{customRender:"dishurl"}},{title:"商品名称",dataIndex:"dishname",width:100,align:"center"},{title:"商品价格",width:100,dataIndex:"dishprice",align:"center"},{title:"商品介绍",width:100,dataIndex:"description",align:"center"},{title:"是否显示",width:100,dataIndex:"dishstatus",align:"center",scopedSlots:{customRender:"dishstatus"}},{title:"操作",width:100,dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],h={components:{MenuDishChange:u.default,MenuDishInfo:d.default},data:function(){return{columns:f,dataSource:[],selectedRowKeys:[],loading:!1,switchLoading:!1,show:!1,storeId:0,menuShowVisible:!1,menuChangeVisible:!1,showData:{}}},created:function(){},mounted:function(){var e,t=this;l.a.$on("transferCategory",(e=c()(o.a.mark(function e(n){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.storeId=n.storeId,e.next=3,t.getMenuCategoryList(n);case 3:"空"!==(a=e.sent).data.data[n.category]?t.dataSource=a.data.data[n.category]:t.dataSource=[],t.loading=!1;case 6:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},methods:{getMenuCategoryList:function(e){this.loading=!0;var t={storeid:e.storeId};return this.$get("/backend/business/LantianDishmanagement/MapAllByStoreId",i()({},t))},onSelectChange:function(e){this.selectedRowKeys=e},onSwitch:function(e,t){var n=this,a=this;this.switchLoading=!0;var s={id:t.id,dishstatus:e?1:0};this.$put("/backend/business/LantianDishmanagement",i()({},s)).then(function(){a.dataSource.forEach(function(n){n.id===t.id&&(n.dishstatus=e?1:0)}),n.switchLoading=!1,n.$message.success("修改成功")},function(){n.$message.error("修改失败")})},onOpenMenuChangeModal:function(e){this.menuChangeVisible=!0,this.showData=e},onCloseMenuChangeModal:function(){this.menuChangeVisible=!1},onCancelMenuChangeModal:function(){this.menuChangeVisible=!1},onOpenMenushowModal:function(e){this.showData=e,this.menuShowVisible=!0},onCloseMenuShowModal:function(){this.menuShowVisible=!1},onCancelMenuShowModal:function(){this.menuShowVisible=!1},onDeleteMenuDish:function(e){var t=this;this.$delete("/backend/business/LantianDishmanagement/"+e.id).then(function(n){if(200==n.data.code){t.$message.success("删除"+e.dishname+"成功");var a=t.dataSource.filter(function(t){return t.id!=e.id});t.dataSource=a}else t.$message.success("删除删除")})}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-table",{attrs:{dataSource:e.dataSource,columns:e.columns,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},loading:e.loading},scopedSlots:e._u([{key:"dishurl",fn:function(e,t){return n("span",{},[n("img",{staticStyle:{width:"200px",heigth:"auto"},attrs:{src:JSON.parse(t.dishurl)}})])}},{key:"dishstatus",fn:function(t,a){return n("span",{},[n("a-switch",{attrs:{loading:e.switchLoading},on:{change:function(t){e.onSwitch(t,a)}},model:{value:1==a.dishstatus,callback:function(t){e.$set(a,"dishstatus == 1 ? true : false",t)},expression:"record.dishstatus == 1 ? true : false"}},[n("a-icon",{attrs:{slot:"checkedChildren",type:"check"},slot:"checkedChildren"}),e._v(" "),n("a-icon",{attrs:{slot:"unCheckedChildren",type:"close"},slot:"unCheckedChildren"})],1)],1)}},{key:"action",fn:function(t,a){return n("span",{},[n("a",{on:{click:function(t){return e.onOpenMenuChangeModal(a)}}},[e._v("修改")]),e._v(" "),n("a-divider",{attrs:{type:"vertical"}}),e._v(" "),n("a",{on:{click:function(t){return e.onOpenMenushowModal(a)}}},[e._v("查看")]),e._v(" "),n("a-divider",{attrs:{type:"vertical"}}),e._v(" "),n("a-popconfirm",{attrs:{title:"确定删除该菜品","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(t){return e.onDeleteMenuDish(a)}}},[n("a",[e._v("删除")])])],1)}}])}),e._v(" "),n("menu-dish-change",{attrs:{changeVisible:e.menuChangeVisible,data:e.showData},on:{close:e.onCloseMenuChangeModal,cancel:e.onCancelMenuChangeModal}}),e._v(" "),n("menu-dish-info",{attrs:{showVisible:e.menuShowVisible,data:e.showData},on:{close:e.onCloseMenuShowModal,cancel:e.onCancelMenuShowModal}})],1)},staticRenderFns:[]},g=n("VU/8")(h,m,!1,function(e){n("FbN+")},null,null);t.default=g.exports},if12:function(e,t){},zSEg:function(e,t){},zVzY:function(e,t){}});